**SMTP (25)**
	
**What is smtp ?**
		
SMTP or Simple Mail Transfer Protocol is an application that is used to send, receive, and relay outgoing emails between senders and receivers.It is sometimes paired with IMAP or POP3, which handles the retrieval of messages, while SMTP primarily sends messages to a server for forwarding.
	
**Default port**		
		
      25, 465(ssl), 587(ssl)
	
 **Default File Location**
		
You can find the main configuration for Postfix Linux mail server in the /etc/postfix/main.cf file.
		
**Identifying SMTP server** 
		
	 # nmap -v -p 25 $ip
		
**Banner grabbing**
		
    # nc -nv $ip 25
	
**Connection**

    # telnet $ip 25
		
**Enumeration and vuln scanning**		
		
     # nmap -v -sC -sV -sT -script smtp-brute,smtp-commands,smtp-enum-users,smtp-ntlm-info,smtp-open-relay,smtp-strangeport,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 -p $ip
	
  Where -v for Verbose mode, -sC for Script Scan and -sV for Version Detection.
	
**User enumeration with smtp-user-enum command**		
		
    # apt-get install smtp-user-enum
		
    # smtp-user-enum -M VRFY -U username.txt -t $ip
		 
    # smtp-user-enum -M VRFY -u root -t $ip
		
    # smtp-user-enum -M VRFY -D metasploitable.localadmin -u root -t $ip

where -M for Mode, -U for username file list, -u for single user name, -d for domain & -t for host.
		
**Command to check VRFY user**
		
    VRFY root
		
**Command to ask EXPN mailing list**	
		
    EXPN root
	
**Command to check RCPT TO**		
		  
    RCPT TO:admin
	
**User Enumeration with Metasploit**		
		  
    # msfconsole
    
    > use auxiliary/scanner/smtp/smtp_enum
    
    > set RHOSTS $ip
    
    > run
		
In this metasploit module you can also add username list file where your smtp user with set USER_FILE filename command.
		
   **SMTP version Detection with metasploit**
		
  > use auxiliary/scanner/smtp/smtp_version
 
  > set RHOSTS $ip

  > run 
	
**Brute Force**			
		  
    # hydra -l username -P Password.txt smtp://$ip
    
    # hydra -L username.txt -P Password.txt smtp://$ip
			
			
	
	
	
	

		
		
		
	
		
		
		
		








		
	
	

		
